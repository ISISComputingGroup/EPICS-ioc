
# this is set externally by RunControl
record(waveform, "$(P)CS:RC:_OUT")
{
	field(NELM, "256")
	field(FTVL, "CHAR")
	field(FLNK, "$(P)CS:RC:_OUT:DO.PROC")
}	

# name of set, stored in a PV as need to used as INLINK 
record(stringin, "$(P)CS:RC:_SETNAME")
{
	field(VAL, "RC")
}	

record(aSub, "$(P)CS:RC:_OUT:DO")
{
    field(SNAM, "addToSet")
	field(INPA, "$(P)CS:RC:_SETNAME")
	field(FTA, "STRING")
	field(INPB, "$(P)CS:RC:_OUT")
	field(FTB, "CHAR")
	field(NOB, "256")
	field(INPC, "$(P)CS:RC:_OUT.NELM") # NORD not set by CA
	field(FTC, "LONG")
	field(FLNK, "$(P)CS:RC:_OUT:CNT.PROC")
	
}

# this is set externally by RunControl
record(waveform, "$(P)CS:RC:_IN")
{
	field(NELM, "256")
	field(FTVL, "CHAR")
	field(FLNK, "$(P)CS:RC:_IN:DO.PROC")
}	

record(aSub, "$(P)CS:RC:_IN:DO")
{
    field(SNAM, "removeFromSet")
	field(INPA, "$(P)CS:RC:_SETNAME")
	field(FTA, "STRING")
	field(INPB, "$(P)CS:RC:_IN")
	field(FTB, "CHAR")
	field(NOB, "256")
	field(INPC, "$(P)CS:RC:_IN.NELM") # NORD not set by CA
	field(FTC, "LONG")
	field(FLNK, "$(P)CS:RC:_OUT:CNT.PROC")
}

record(aSub, "$(P)CS:RC:_OUT:CNT")
{
    field(SNAM, "getSetItemCount")
	field(INPA, "$(P)CS:RC:_SETNAME")
	field(FTA, "STRING")
	field(OUTA, "$(P)CS:RC:OUT:CNT PP")
	field(FTVA, "LONG")
	field(FLNK, "$(P)CS:RC:_CALC.PROC")
} 

record(longin, "$(P)CS:RC:OUT:CNT")
{
    field(VAL, "0")
}

# use a calcout record to avoid writing to OUT:LIST too often and triggering unnecessary monitors  
record(calcout, "$(P)CS:RC:_CALC")
{
    field(INPA, "$(P)CS:RC:OUT:CNT")
	field(CALC, "A")
	field(OOPT, "On Change")
	field(DOPT, "Use CALC")
	field(OUT, "$(P)CS:RC:_CALC2.PROC")
}	

record(calcout, "$(P)CS:RC:_CALC2")
{
    field(INPA, "$(P)CS:RC:OUT:CNT")
	field(CALC, "A > 0 ? 5 : 3")
	field(OOPT, "Every Time")
	field(DOPT, "Use CALC")
	field(OUT, "$(P)CS:RC:_SEQ.SELN")
	field(FLNK, "$(P)CS:RC:_SEQ.PROC")
}	

record(seq, "$(P)CS:RC:_SEQ")
{
    field(SELM, "Mask")
	field(DO1, 1)
	field(DO2, 1)
	field(DO3, 1)
	field(LNK1, "$(P)CS:RC:_OUT:LIST.PROC")
	field(LNK2, "$(P)DAE:ENDSEWAIT PP")
	field(LNK3, "$(P)DAE:STARTSEWAIT PP")
}

record(aSub, "$(P)CS:RC:_OUT:LIST")
{
    field(SNAM, "getSetItems")
	field(INPA, "$(P)CS:RC:_SETNAME")
	field(FTA, "STRING")
	field(OUTA, "$(P)CS:RC:OUT:LIST PP")
	field(FTVA, "CHAR")
	field(NOVA, "4096")
	field(FTVB, "LONG")
} 

record(waveform, "$(P)CS:RC:OUT:LIST")
{
	field(NELM, "4096")
	field(FTVL, "CHAR")
}


#	NEA
#	field(OUTA
#	field(FTVA
#	field(NOVA
#	NEVA
#