record(ai, "$(P)RF_LEVEL")
{
    field(SCAN, "2 second")
    field(DESC, "RF level")
    field(DTYP, "stream")
	field(EGU, "DBM")

    field(INP, "@aeroflex_common.proto getRFLevel $(PORT)")
	
	field(PREC, "2")
    info(INTEREST, "HIGH")
    field(SIML, "$(P)SIM")
    field(SIOL, "$(P)SIM:RF_LEVEL")
}

record(ao, "$(P)RF_LEVEL:SP")
{
    field(DESC, "Set RF level")
	field(DTYP, "stream")
	field(OUT, "@aeroflex_common.proto setRFLevel $(PORT)")
	field(PREC, "2")
}

record(ao, "$(P)RF_LEVEL:SP_NO_ACTION")
{
	field(PREC, "2")
	info(autosaveFields, "VAL")
}

record(mbbi, "$(P)MODE")
{
    field(SCAN, "2 second")
    field(DESC, "Get modulation")
    field(DTYP, "stream")

    field(INP, "@aeroflex.proto getModulation $(PORT)")
	
	field(ZRST, "AM,FM")
	field(ONST, "AM,PM")
	field(TWST, "AM")
	field(THST, "FM,PULSE")
	field(FRST, "FM")
	field(FVST, "PM,PULSE")
	field(SXST, "PM")
	
    info(INTEREST, "HIGH")
    field(SIML, "$(P)SIM")
    field(SIOL, "$(P)SIM:MODE")
}

record(mbbo, "$(P)MODE:SP_NO_ACTION")
{
	info(autosaveFields, "VAL")
	
	field(ZRST, "AM,FM")
	field(ONST, "AM,PM")
	field(TWST, "AM")
	field(THST, "FM,PULSE")
	field(FRST, "FM")
	field(FVST, "PM,PULSE")
	field(SXST, "PM")
}

record(mbbo, "$(P)MODE:SP")
{
    field(DESC, "Set modulation")
    field(SCAN, "Passive")
    field(DTYP, "stream")
    field(OUT, "@aeroflex.proto setModulation $(PORT)")
	
	field(ZRST, "AM,FM")
	field(ONST, "AM,PM")
	field(TWST, "AM")
	field(THST, "FM,PULSE")
	field(FRST, "FM")
	field(FVST, "PM,PULSE")
	field(SXST, "PM")
}

record(calcout, "$(P)SEND_MODE_PARAMS")
{
    field(DESC, "Set modulation button")
    field(SCAN, "Passive")
	field(INPA, "$(P)MODE:SP_NO_ACTION")
	field(INPB, "$(P)PULSE_CHECK:SP")
	field(CALC, "((B=0)||(A<4))?A:(A-1)")
	field(OUT, "$(P)MODE:SP PP")
}
