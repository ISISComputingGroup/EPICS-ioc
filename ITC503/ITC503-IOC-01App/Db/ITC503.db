record(bo, "$(P)SIM")
{
    field(SCAN, "Passive")
    field(DTYP, "Soft Channel")
    field(ZNAM, "NO")
    field(ONAM, "YES")
    field(VAL, "$(RECSIM=0)")
    field(PINI, "YES")
}

record(bo, "$(P)DISABLE")
{
    field(DESC, "Disable comms")
    field(PINI, "YES")
    field(VAL, "$(DISABLE=0)")
    field(OMSL, "supervisory")
    field(ZNAM, "COMMS ENABLED")
    field(ONAM, "COMMS DISABLED")
}

record(ai, "$(P)P") {
  field(DESC, "Get PID P")
  field(SCAN, "Passive")
  field(DTYP, "stream")
  field(INP, "@itc503.proto get_p $(PORT)")
  field(PREC, "1")
  field(EGU, "")
  field(SIML, "$(P)SIM")
  field(SIOL, "$(P)SIM:P")
  field(SDIS, "$(P)DISABLE")
  info(INTEREST, "MEDIUM")
  info(archive, "VAL")
}

record(ao, "$(P)P:SP") {
  field(DESC, "Set PID P")
  field(SCAN, "Passive")
  field(DTYP, "stream")
  field(OUT, "@itc503.proto set_p $(PORT)")
  field(OMSL, "supervisory")
  field(PREC, "1")
  field(EGU, "")
  field(SIML, "$(P)SIM")
  field(SIOL, "$(P)SIM:P:SP")
  field(SDIS, "$(P)DISABLE")
}

record(ao, "$(P)I:SP") {
  field(DESC, "Set PID I")
  field(SCAN, "Passive")
  field(DTYP, "stream")
  field(OUT, "@itc503.proto set_i $(PORT)")
  field(OMSL, "supervisory")
  field(PREC, "1")
  field(EGU, "")
  field(SIML, "$(P)SIM")
  field(SIOL, "$(P)SIM:I:SP")
  field(SDIS, "$(P)DISABLE")
}

record(ai, "$(P)I") {
  field(DESC, "Get PID I")
  field(SCAN, "Passive")
  field(DTYP, "stream")
  field(INP, "@itc503.proto get_i $(PORT)")
  field(PREC, "1")
  field(EGU, "")
  field(SIML, "$(P)SIM")
  field(SIOL, "$(P)SIM:I")
  field(SDIS, "$(P)DISABLE")
  info(INTEREST, "MEDIUM")
  info(archive, "VAL")
}

record(ao, "$(P)D:SP") {
  field(DESC, "Set PID D")
  field(SCAN, "Passive")
  field(DTYP, "stream")
  field(OUT, "@itc503.proto set_d $(PORT)")
  field(OMSL, "supervisory")
  field(PREC, "1")
  field(EGU, "")
  field(SIML, "$(P)SIM")
  field(SIOL, "$(P)SIM:D:SP")
  field(SDIS, "$(P)DISABLE")
}

record(ai, "$(P)D") {
  field(DESC, "Get PID D")
  field(SCAN, "Passive")
  field(DTYP, "stream")
  field(INP, "@itc503.proto get_d $(PORT)")
  field(PREC, "1")
  field(EGU, "")
  field(SIML, "$(P)SIM")
  field(SIOL, "$(P)SIM:D")
  field(SDIS, "$(P)DISABLE")
  info(INTEREST, "MEDIUM")
  info(archive, "VAL")
}

record(ai, "$(P)GASFLOW") {
  field(DESC, "Get gas flow")
  field(SCAN, "Passive")
  field(DTYP, "stream")
  field(INP, "@itc503.proto get_gflow $(PORT)")
  field(PREC, "1")
  field(EGU, "%")
  field(SIML, "$(P)SIM")
  field(SIOL, "$(P)SIM:GASFLOW")
  field(SDIS, "$(P)DISABLE")
  info(INTEREST, "MEDIUM")
  info(archive, "VAL")
}

record(ao, "$(P)GASFLOW:SP") {
  field(DESC, "Set gas flow")
  field(SCAN, "Passive")
  field(DTYP, "stream")
  field(OUT, "@itc503.proto set_gflow $(PORT)")
  field(OMSL, "supervisory")
  field(PREC, "1")
  field(EGU, "%")
  field(SIML, "$(P)SIM")
  field(SIOL, "$(P)SIM:GASFLOW:SP")
  field(SDIS, "$(P)DISABLE")
}

record(mbbi, "$(P)MODE") {
  field(DESC, "Get status")
  field(SCAN, "Passive")
  field(DTYP, "stream")
  field(INP, "@itc503.proto get_sta($(P)) $(PORT)")
  field(ZRVL, "0")
  field(ONVL, "1")
  field(TWVL, "2")
  field(THVL, "3")
  field(ZRST, "Man heater, man flow")
  field(ONST, "Auto heater, man flow")
  field(TWST, "Man heater, auto flow")
  field(THST, "Auto gas, auto flow")
  field(SIML, "$(P)SIM")
  field(SIOL, "$(P)SIM:MODE")
  field(SDIS, "$(P)DISABLE")
  info(INTEREST, "LOW")
  info(archive, "VAL")
}

record(mbbo, "$(P)MODE:SP") {
  field(DESC, "Set auto or man")
  field(SCAN, "Passive")
  field(DTYP, "stream")
  field(OUT, "@itc503.proto set_act $(PORT)")
  field(ZRVL, "0")
  field(ONVL, "1")
  field(TWVL, "2")
  field(THVL, "3")
  field(ZRST, "Man heater, man flow")
  field(ONST, "Auto heater, man flow")
  field(TWST, "Man heater, auto flow")
  field(THST, "Auto gas, auto flow")
  field(SIML, "$(P)SIM")
  field(SIOL, "$(P)SIM:MODE:SP")
  field(SDIS, "$(P)DISABLE")
}

record(mbbi, "$(P)CTRL") {
  field(DESC, "Get control")
  field(DTYP, "Soft Channel")
  field(ZRVL, "0")
  field(ONVL, "1")
  field(TWVL, "2")
  field(THVL, "3")
  field(ZRST, "FPLock")
  field(ONST, "EPICS+FPLock")
  field(TWST, "FPUnlock")
  field(THST, "EPICS+FPUnlock")
  field(SIML, "$(P)SIM")
  field(SIOL, "$(P)SIM:CTRL")
  field(SDIS, "$(P)DISABLE")
  info(INTEREST, "LOW")
  info(archive, "VAL")
}

record(mbbo, "$(P)CTRL:SP") {
  field(DESC, "Set control")
  field(SCAN, "Passive")
  field(PINI, "YES")
  field(DTYP, "stream")
  field(VAL, "1")
  field(OUT, "@itc503.proto set_ctrl $(PORT)")
  field(ZRVL, "0")
  field(ONVL, "1")
  field(TWVL, "2")
  field(THVL, "3")
  field(ZRST, "FPLock")
  field(ONST, "EPICS+FPLock")
  field(TWST, "FPUnlock")
  field(THST, "EPICS+FPUnlock")
  field(SIML, "$(P)SIM")
  field(SIOL, "$(P)SIM:CTRL:SP")
  field(SDIS, "$(P)DISABLE")
}

record(ai, "$(P)TEMP1") {
  field(DESC, "Get sensor 1 temp")
  field(SCAN, "Passive")
  field(DTYP, "stream")
  field(INP, "@itc503.proto get_stemp $(PORT)")
  field(PREC, "4")
  field(EGU, "K")
  field(SIML, "$(P)SIM")
  field(SIOL, "$(P)SIM:TEMP")
  field(SDIS, "$(P)DISABLE")
  info(INTEREST, "HIGH")
  info(archive, "VAL")
}

record(ai, "$(P)TEMP2") {
  field(DESC, "Get sensor 2 temp")
  field(SCAN, "Passive")
  field(DTYP, "stream")
  field(INP, "@itc503.proto get_s2temp $(PORT)")
  field(PREC, "4")
  field(EGU, "K")
  field(SIML, "$(P)SIM")
  field(SIOL, "$(P)SIM:TEMP")
  field(SDIS, "$(P)DISABLE")
  info(INTEREST, "HIGH")
  info(archive, "VAL")
}

record(ai, "$(P)TEMP3") {
  field(DESC, "Get sensor 3 temp")
  field(SCAN, "Passive")
  field(DTYP, "stream")
  field(INP, "@itc503.proto get_s3temp $(PORT)")
  field(PREC, "4")
  field(EGU, "K")
  field(SIML, "$(P)SIM")
  field(SIOL, "$(P)SIM:TEMP")
  field(SDIS, "$(P)DISABLE")
  info(INTEREST, "HIGH")
  info(archive, "VAL")
}

record(ao, "$(P)TTEMP:SP") {
  field(DESC, "Set target temp")
  field(SCAN, "Passive")
  field(DTYP, "stream")
  field(OUT, "@itc503.proto set_ttemp $(PORT)")
  field(OMSL, "supervisory")
  field(PREC, "2")
  field(EGU, "K")
  field(SIML, "$(P)SIM")
  field(SIOL, "$(P)SIM:TTEMP:SP")
  field(SDIS, "$(P)DISABLE")
}

record(ai, "$(P)TTEMP") {
  field(DESC, "Get target temp")
  field(SCAN, "Passive")
  field(DTYP, "stream")
  field(INP, "@itc503.proto get_ttemp $(PORT)")
  field(PREC, "2")
  field(EGU, "K")
  field(SIML, "$(P)SIM")
  field(SIOL, "$(P)SIM:TTEMP")
  field(SDIS, "$(P)DISABLE")
  info(INTEREST, "HIGH")
  info(archive, "VAL")
}

record(ai, "$(P)TEMP:ERR") {
  field(DESC, "Get temp error")
  field(SCAN, "Passive")
  field(DTYP, "stream")
  field(INP, "@itc503.proto get_etemp $(PORT)")
  field(PREC, "2")
  field(EGU, "K")
  field(SIML, "$(P)SIM")
  field(SIOL, "$(P)SIM:TEMP:ERR")
  field(SDIS, "$(P)DISABLE")
}

record(ai, "$(P)HEATERP") {
  field(DESC, "Get heater %")
  field(SCAN, "Passive")
  field(DTYP, "stream")
  field(INP, "@itc503.proto get_htrp $(PORT)")
  field(PREC, "0")
  field(EGU, "%")
  field(SIML, "$(P)SIM")
  field(SIOL, "$(P)SIM:HEATERV")
  field(SDIS, "$(P)DISABLE")
  info(INTEREST, "MEDIUM")
  info(archive, "VAL")
}

record(ai, "$(P)HEATERV") {
  field(DESC, "Get heater volts")
  field(SCAN, "Passive")
  field(DTYP, "stream")
  field(INP, "@itc503.proto get_htrv $(PORT)")
  field(PREC, "1")
  field(EGU, "V")
  field(SIML, "$(P)SIM")
  field(SIOL, "$(P)SIM:HEATERV")
  field(SDIS, "$(P)DISABLE")
  info(INTEREST, "MEDIUM")
  info(archive, "VAL")
}


#
# At ISIS this should only be set by cryogenics and never by the user.
#
# There is potential for damaging cryostats if this is set incorrectly so
# remove this PV for now. If it is needed, this record can be uncommented.
# 
# record(ao, "$(P)HEATERV:MAX") {
#   field(DESC, "Set max htr v")
#   field(SCAN, "Passive")
#   field(DTYP, "stream")
#   field(OUT, "@itc503.proto set_maxv $(PORT)")
#   field(OMSL, "supervisory")
#   field(PREC, "1")
#   field(EGU, "V")
#   field(SIML, "$(P)SIM")
#   field(SIOL, "$(P)SIM:HEATERV:MAX")
#   field(SDIS, "$(P)DISABLE")
#   info(INTEREST, "MEDIUM")
#   info(archive, "VAL")
# }

record(ao, "$(P)HEATERV:SP") {
  field(DESC, "Set man htr v")
  field(SCAN, "Passive")
  field(DTYP, "stream")
  field(OUT, "@itc503.proto set_manv $(PORT)")
  field(OMSL, "supervisory")
  field(PREC, "1")
  field(EGU, "V")
  field(SIML, "$(P)SIM")
  field(SIOL, "$(P)SIM:HEATERV:SP")
  field(SDIS, "$(P)DISABLE")
}

record(mbbi, "$(P)SWEEPING") {
  field(DESC, "Sweeping")
  field(SCAN, "Passive")
  field(ZRVL, "0")
  field(ONVL, "1")
  field(TWVL, "2")
  field(ZRST, "Not Sweeping")
  field(ONST, "Sweeping")
  field(TWST, "Unknown")
}

record(mbbi, "$(P)CTRLCHANNEL") {
  field(DESC, "Control channel")
  field(SCAN, "Passive")
  field(ZRVL, "0")
  field(ONVL, "1")
  field(TWVL, "2")
  field(THVL, "3")
  field(ZRST, "Channel 1")
  field(ONST, "Channel 2")
  field(TWST, "Channel 3")
  field(THST, "Unknown")
  field(SIML, "$(P)SIM")
  field(SIOL, "$(P)SIM:CTRLCHANNEL")
  field(SDIS, "$(P)DISABLE")
}

record(mbbo, "$(P)CTRLCHANNEL:SP") {
  field(DESC, "Control channel")
  field(SCAN, "Passive")
  field(ZRVL, "0")
  field(ONVL, "1")
  field(TWVL, "2")
  field(ZRST, "Channel 1")
  field(ONST, "Channel 2")
  field(TWST, "Channel 3")
  field(DTYP, "stream")
  field(OUT, "@itc503.proto set_ctrl_chan $(PORT)")
  field(SIML, "$(P)SIM")
  field(SIOL, "$(P)SIM:CTRLCHANNEL:SP")
  field(SDIS, "$(P)DISABLE")
}

record(bi, "$(P)AUTOPID") {
  field(DESC, "Automatic PID")
  field(SCAN, "Passive")
  field(ZNAM, "OFF")
  field(ONAM, "ON")
  field(SIML, "$(P)SIM")
  field(SIOL, "$(P)SIM:AUTOPID")
  field(SDIS, "$(P)DISABLE")
  info(INTEREST, "MEDIUM")
  info(archive, "VAL")
}

record(bo, "$(P)AUTOPID:SP") {
  field(DESC, "Automatic PID setpoint")
  field(SCAN, "Passive")
  field(OUT, "@itc503.proto set_auto_pid $(PORT)")
  field(DTYP, "stream")
  field(ZNAM, "OFF")
  field(ONAM, "ON")
  field(SIML, "$(P)SIM")
  field(SIOL, "$(P)SIM:AUTOPID:SP")
  field(SDIS, "$(P)DISABLE")
}





record(seq, "$(P)FAN1") {
  field(SCAN, "10 second")
  field(SDIS, "$(P)DISABLE")
  field(SELM, "All")
  field(LNK1, "$(P)P.PROC PP")
  field(LNK2, "$(P)I.PROC PP")
  field(LNK3, "$(P)D.PROC PP")
  field(LNK4, "$(P)TEMP1.PROC PP")
  field(LNK5, "$(P)TTEMP.PROC PP")
  field(LNK6, "$(P)TEMP:ERR.PROC PP")
  field(LNK7, "$(P)FAN2.PROC PP")
  field(LNK8, "$(P)FAN1.DESC")      
  field(DLY2, "1.0")
  field(DLY3, "1.0")
  field(DLY4, "1.0")
  field(DLY5, "1.0")
  field(DLY6, "1.0")   
  field(DLY7, "1.0")   
  field(DLY8, "7.0")     
}

record(seq, "$(P)FAN2") {
  field(SELM, "All")
  field(LNK1, "$(P)HEATERP.PROC PP")
  field(LNK2, "$(P)HEATERV.PROC PP")
  field(LNK3, "$(P)MODE.PROC PP")
  field(LNK4, "$(P)GASFLOW.PROC PP")  
  field(LNK5, "$(P)TEMP2.PROC PP")
  field(LNK6, "$(P)TEMP3.PROC PP")
  field(DLY2, "1.0")
  field(DLY3, "1.0")
  field(DLY4, "1.0")
  field(DLY5, "1.0")
  field(DLY6, "1.0")
}




####################################
####################################
####################################
######## Simulation records ########
####################################
####################################
####################################



record(ao, "$(P)SIM:P"){}
alias("$(P)SIM:P", "$(P)SIM:P:SP")

record(ao, "$(P)SIM:I"){}
alias("$(P)SIM:I", "$(P)SIM:I:SP")

record(ao, "$(P)SIM:D"){}
alias("$(P)SIM:D", "$(P)SIM:D:SP")

record(ao, "$(P)SIM:SHIELDFLW"){}
alias("$(P)SIM:SHIELDFLW", "$(P)SIM:SHIELDFLW:SP")

record(ao, "$(P)SIM:SAMPLEFLW"){}
alias("$(P)SIM:SAMPLEFLW", "$(P)SIM:SAMPLEFLW:SP")

record(ao, "$(P)SIM:GASFLOW"){}
alias("$(P)SIM:GASFLOW", "$(P)SIM:GASFLOW:SP")

record(mbbo, "$(P)SIM:MODE:SP") {
  field(ZRVL, "0")
  field(ONVL, "1")
  field(TWVL, "2")
  field(THVL, "3")
  field(ZRST, "Man heater, man flow")
  field(ONST, "Auto heater, man flow")
  field(TWST, "Man heater, auto flow")
  field(THST, "Auto gas, auto flow")
}
alias("$(P)SIM:MODE:SP", "$(P)SIM:MODE")

record(ao, "$(P)SIM:HEATERV"){}

record(ao, "$(P)SIM:TEMP"){}
alias("$(P)SIM:TEMP", "$(P)SIM:TTEMP:SP")
alias("$(P)SIM:TEMP", "$(P)SIM:TTEMP")

record(mbbo, "$(P)SIM:CTRL") {
  field(ZRVL, "0")
  field(ONVL, "1")
  field(TWVL, "2")
  field(THVL, "3")
  field(ZRST, "FPLock")
  field(ONST, "EPICS+FPLock")
  field(TWST, "FPUnlock")
  field(THST, "EPICS+FPUnlock")
}
alias("$(P)SIM:CTRL", "$(P)SIM:CTRL:SP")

record(mbbo, "$(P)SIM:CTRLCHANNEL") {
  field(ZRVL, "0")
  field(ONVL, "1")
  field(TWVL, "2")
  field(THVL, "3")
  field(ZRST, "Channel 1")
  field(ONST, "Channel 2")
  field(TWST, "Channel 3")
  field(THST, "Unknown")
}
alias("$(P)SIM:CTRLCHANNEL", "$(P)SIM:CTRLCHANNEL:SP")

record(bo, "$(P)SIM:AUTOPID") {
  field(ZNAM, "OFF")
  field(ONAM, "ON")
}
alias("$(P)SIM:AUTOPID", "$(P)SIM:AUTOPID:SP")
