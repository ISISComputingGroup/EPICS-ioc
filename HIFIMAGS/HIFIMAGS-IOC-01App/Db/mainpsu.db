### Main Readbacks for backwards compatibility

alias("$(P)$(MAG):STAT","$(P)MAIN:STAT:RBV")
alias("$(P)$(MAG):READY","$(P)MAIN:READY:RBV")
alias("$(P)$(MAG):ERRORS:RBV", "$(P)MAIN:ERRORS:RBV")
alias("$(P)$(MAG):OUTPUT:FIELD:GAUSS","$(P)MAIN:OUT:RBV")
alias("$(P)$(MAG):TARGET:TIME","$(P)MAIN:MINTO:RBV")

### Main - Ramp Leads

record(bo, "$(P)$(MAG):RAMP:LEADS:SP") {
  field(DESC, "Ramp Leads of $(MAG)")
  field(DTYP, "Soft Channel")
  field(SCAN, "1 second")
  
  field(OUT,"$(PVPREFIX)$(PSU_IOC):RAMP:LEADS:SP")
  
  field(ZNAM, "Not Ramping")
  field(ONAM, "Ramping")
  
  field(SIML, "$(P)SIM")
  field(SIOL, "$(P)SIM:$(MAG):RAMP:LEADS")
  field(SDIS, "$(P)DISABLE")
}

record(bi, "$(P)$(MAG):RAMP:LEADS") {
  field(DESC, "Whether or not $(MAG) leads will be ramped")
  field(DTYP, "Soft Channel")
  field(SCAN, "1 second")
  
  field(INP,"$(PVPREFIX)$(PSU_IOC):RAMP:LEADS")
  
  field(ZNAM, "Not Ramping")
  field(ONAM, "Ramping")
  
  field(SIML, "$(P)SIM")
  field(SIOL, "$(P)SIM:$(MAG):RAMP:LEADS")
  field(SDIS, "$(P)DISABLE")
}


record(bi, "$(P)SIM:$(MAG):RAMP:LEADS") {
  field(DESC, "Simulated lead ramping of $(MAG)")
  field(DTYP, "Soft Channel")
  
  field(ZNAM, "Not Ramping")
  field(ONAM, "Ramping")
}

### Main - Persist Mode

record(bo, "$(P)$(MAG):PERSIST:SP") {
  field(DESC, "Persist Mode of $(MAG)")
  field(DTYP, "Soft Channel")
  field(SCAN, "1 second")
  
  field(OUT,"$(PVPREFIX)$(PSU_IOC):PERSIST:SP")
  
  field(ZNAM, "Non persisting")
  field(ONAM, "Persisting")
  
  field(SIML, "$(P)SIM")
  field(SIOL, "$(P)SIM:$(MAG):PERSIST")
  field(SDIS, "$(P)DISABLE")
}

record(bi, "$(P)$(MAG):PERSIST") {
  field(DESC, "Whether or not $(MAG) is persisting")
  field(DTYP, "Soft Channel")
  field(SCAN, "1 second")
  
  field(INP,"$(PVPREFIX)$(PSU_IOC):PERSIST")
  
  field(ZNAM, "Non persisting")
  field(ONAM, "Persisting")
  
  field(SIML, "$(P)SIM")
  field(SIOL, "$(P)SIM:$(MAG):PERSIST")
  field(SDIS, "$(P)DISABLE")
}


record(bi, "$(P)SIM:$(MAG):PERSIST") {
  field(DESC, "Simulated persistent mode of $(MAG)")
  field(DTYP, "Soft Channel")
  
  field(ZNAM, "Non persisting")
  field(ONAM, "Persisting")
}

### Main - Persistent Field value

record(ai, "$(P)$(MAG):OUTPUT:FIELD:PERSIST:GAUSS") {
  field(DESC, "Persistent Field of $(MAG) in Gauss")
  field(DTYP, "Soft Channel")
  field(SCAN, "1 second")
  field(EGU, "Gauss")
  
  field(INP,"$(PVPREFIX)$(PSU_IOC):OUTPUT:FIELD:PERSIST:GAUSS")
  
  field(SIML, "$(P)SIM")
  field(SIOL, "$(P)SIM:$(MAG):OUTPUT:FIELD:PERSIST:GAUSS")
  field(SDIS, "$(P)DISABLE")
}

record(ai, "$(P)SIM:$(MAG):OUTPUT:FIELD:PERSIST:GAUSS") {
  field(DESC, "Simulated Persistent Field of $(MAG) in Gauss")
  field(DTYP, "Soft Channel")
  field(EGU,"Gauss")
}